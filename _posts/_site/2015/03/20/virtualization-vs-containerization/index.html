<h3 class="post-title entry-title">Virtualization vs. Containerization</h3>
<div class="post-header"></div>
<div id="post-body-3523378071560035813" class="post-body entry-content">Containers provide isolated runtime environments for applications: the entire user space environment is exclusively presented to the container, and any changes to it do not impact other containers' environments. To provide this isolation, a combination of OS-based mechanisms is used: Linux name spaces are used for isolation and scoping mechanism. File system mounts define what files are accessible to the container. cgroups define resource consumption of containers. Still all containers share the same OS kernel which can realize memory footprint efficiencies when identical libraries are used by multiple containers.</p>
<p>With system virtualization, the hypervisor provides a full virtual machine to a guest: the entire OS image including the kernel is now dedicated to the virtual machine. CPU virtualization is used to provide each guest with an exclusive view of a full system environment, and these mechanisms also ensure isolation from other guests. Hypervisor-based management of virtual CPUs, memory and I/O devices is used to define resource consumption of guests.</p>
<h4>Which one is better?</h4>
<p><a name="more"></a><br />
As always, it depends on your needs. If you just want to have a number of separate instances to run applications, a <i><b>container</b></i> environment often provides greater efficiency, both in managing the application environment, starting the application instances, and in resource consumption. Simple modification and deployment of application environments has been a design principle of container solutions like Docker and is entirely in the DevOps spirit (guess you just have been waiting for more buzzwords).</p>
<p>If you want to have best isolation of environments and come from a server virtualization perspective, then <b><i>system virtualization</i></b> may be more relevant: Noisy neighbours are much less of an issue than with containers. While many of the container folks currently focus on improving container isolation, virtual machine isolation is still superior. Coming from physical servers, virtual servers are a natural step, and an existing ecosystem around server management can often be applied to virtual servers, too.</p>
<p>On z systems, Linux has good scalability (to run containers), but z is the platform with an extremely efficient virtualization technology (to run virtual servers), and it is inherent in the entire system architecture. Without having measured it, combining the technologies is probably less painful on z Systems than on other platforms.</p>
<p>There is a third way: <i><b>both</b></i>.<br />
Combining system virtualization with containers can be done in multiple ways:</p>
<h4>1. A Virtual Machine in a Container</h4>
<div class="separator"><a href="https://mainframedebate.files.wordpress.com/2015/03/343a1-kvm-in-docker.png"><img src="/assets/2015/03/343a1-kvm-in-docker.png" alt="" width="640" height="369" border="0" /></a></div>
<p>Docker has quite some flexibility on where containers are deployed. One option (called "execution driver") is to use KVM images. This allows to use all the DevOps methods of Docker and combine it with best isolation available, at the cost of having to start up entire Operating System instances when starting containers -- meaning startup time and footprint. Memory efficiencies can only be realized through Kernel Samepage Merging (KSM) -- less effective and efficient, but it's a start.</p>
<h4>2. A Container in a Virtual Machine</h4>
<div class="separator"><a href="https://mainframedebate.files.wordpress.com/2015/03/7a1d7-docker-in-vm.png"><img src="/assets/2015/03/7a1d7-docker-in-vm.png" alt="" width="640" height="406" border="0" /></a></div>
<p>Conversely, you can run a virtual machine and start a container inside. The VM would not be controlled by Docker, but by existing virtualization management infrastructure. Once the OS instance is up, starting a container would then be done using Docker, and no special setup has to be performed for running containers. Again, containers would have strong isolation since the next container runs in another virtual system; footprint-wise, efficiencies would only be possible through memory deduplication techniques by the hypervisor.</p>
<h4>2b. Multiple Containers in a Virtual Machine</h4>
<div class="separator"><a href="https://mainframedebate.files.wordpress.com/2015/03/80ec4-docker-tenant-in-vm.png"><img src="/assets/2015/03/80ec4-docker-tenant-in-vm.png" alt="" width="640" height="402" border="0" /></a></div>
<p>This is a variation of running Docker in a VM, suitable for multi-tenancy environments. Here, the assumption is that strongest isolation is only required between containers of different tenants, and straight Linux container isolation is good enough between several containers of the same tenant. Advantages are lower number of virtual machines to run, best isolation between tenants, and enjoying all the efficiencies of vanilla Docker setups.</p>
<p>To summarize: it depends.</p></div>
<div class="post-body entry-content"></div>
<div class="post-body entry-content">Originally blogged at this location: http://containerz.blogspot.com/2015/03/virtualization-vs-containerization.html#more</div>
